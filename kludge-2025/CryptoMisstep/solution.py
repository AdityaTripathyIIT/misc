from math import gcd
from sympy import Integer, mod_inverse

# Given RSA values
N1 = Integer(14974374473875195262766359759714498503053089849989142350615906604375075459239382918393934480152152984573148364029197563535569579016693018167992085008267715246877019308314343166192794147014444087263931767714815129680445569411486800155271150110026416651278315519324336942487516645161423730875517778762766167915396855151174336633533657407336476616545527054231461490826990389829759499264728585328323976440664382679808975751756846783385844184548542614574407311577363068061643400744101086494410390726961463235329017993736316198284311340752292247507776458773806379773171141374763926767336517205408017407247547356854766802557)
N2 = Integer(11377303457963693647634556693776352306798805099525254752031901804678648636881088711929350495141250697298498818972876217531663484871097255598626665646282624075145714203741838681926335894777136865001180944325695934600392078592647768850802130174507401207814712655854052028437877136817346165867166457069452514683868941704653931712207089672466378364927008362859430206090019244775167988410597771926713180253966174568551154484894125544835941675486240673625466511586254342858049935950702182387012147757215640939517729687181123762690670586402035938005675841656094865670647083004751953376638590052009713204993432574541608076141)
e = 65537

ciphertext = Integer(5062083501536760619375976626223678001228032833977489059486548575914587572407493346747023701174829689562727044045604156604244455786641100182621043440266984010476840470168052478374393062341701327818852016148716894467492537343583037165585878007146816194270009178435075843990690783561214662462610032711751223235548501246807963359358311988543817389414782969736158015382544476715263788094718528348431773426747142692932273961807433917551991954664536126901078849592084204063730539146359400472370682683275213692999485836101435718960735902210958368483009756414525950720645747354056451263930751596812170028619564790831064100649)

# Step 1: Find the shared prime
p = gcd(N1, N2)

# Step 2: Compute q1 and q2
q1 = N1 // p
q2 = N2 // p

# Step 3: Compute phi(N1)
phi = (p - 1) * (q1 - 1)

# Step 4: Compute private exponent
d = mod_inverse(e, phi)

# Step 5: Decrypt ciphertext
plaintext_int = pow(ciphertext, d, N1)

# Convert to bytes and decode (assuming UTF-8 and that it's a printable flag)

plaintext = int(plaintext_int)
plaintext_bytes = plaintext.to_bytes((plaintext.bit_length() + 7) // 8, byteorder='big')
print(plaintext_bytes.decode(errors="ignore"))  # You can adjust decoding as needed
print(plaintext)

